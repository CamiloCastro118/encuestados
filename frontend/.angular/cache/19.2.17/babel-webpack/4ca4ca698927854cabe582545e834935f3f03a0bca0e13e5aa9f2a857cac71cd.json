{"ast":null,"code":"import { CommonModule } from '@angular/common'; // Funciones basicas que se usan siempre\nimport { FormsModule } from '@angular/forms'; // Para poder usar formularios con inputs\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/security.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction LoginComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.errorMessage, \" \");\n  }\n}\nfunction LoginComponent_span_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Iniciando sesi\\u00F3n...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_span_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Ingresar\");\n    i0.ɵɵelementEnd();\n  }\n}\n// Esto le dice a Angular que esta clase es una pagina\nexport let LoginComponent = /*#__PURE__*/(() => {\n  class LoginComponent {\n    router;\n    securityService;\n    // Datos que el usuario escribe en el formulario\n    usuario = ''; // Nombre de usuario o email\n    password = ''; // Contraseña\n    recordarUsuario = false; // Si quiere que recordemos su usuario\n    isLoading = false; // Para mostrar estado de carga\n    errorMessage = ''; // Para mostrar errores\n    // Aqui le decimos a Angular que servicios necesitamos usar\n    constructor(router,\n    // Router para cambiar de pagina\n    securityService // Servicio de seguridad\n    ) {\n      this.router = router;\n      this.securityService = securityService;\n      // No hacer nada aquí que dependa del navegador\n    }\n    ngOnInit() {\n      // Verificar si ya hay una sesión activa al cargar (solo en el navegador)\n      this.securityService.restoreSession();\n      if (this.securityService.isAuthenticated()) {\n        this.redirectToUserHome();\n      }\n      // Cargar usuario recordado\n      if (typeof window !== 'undefined' && localStorage) {\n        const rememberedUser = localStorage.getItem('rememberedUser');\n        if (rememberedUser) {\n          this.usuario = rememberedUser;\n          this.recordarUsuario = true;\n        }\n      }\n    }\n    onSubmit() {\n      // Cuando el usuario hace clic en \"Iniciar Sesion\"\n      if (this.usuario && this.password) {\n        this.isLoading = true;\n        this.errorMessage = '';\n        // Usar el SecurityService para autenticar\n        this.securityService.login(this.usuario, this.password).subscribe({\n          next: response => {\n            this.isLoading = false;\n            if (response.success) {\n              console.log('Login exitoso:', response.user);\n              // Guardar usuario si eligió recordar (solo en el navegador)\n              if (typeof window !== 'undefined' && localStorage) {\n                if (this.recordarUsuario) {\n                  localStorage.setItem('rememberedUser', this.usuario);\n                } else {\n                  localStorage.removeItem('rememberedUser');\n                }\n              }\n              // Redirigir según el rol del usuario\n              this.redirectToUserHome();\n            } else {\n              this.errorMessage = response.message || 'Error en el login';\n            }\n          },\n          error: error => {\n            this.isLoading = false;\n            this.errorMessage = 'Error de conexión. Intenta nuevamente.';\n            console.error('Error en login:', error);\n          }\n        });\n      } else {\n        this.errorMessage = 'Por favor completa todos los campos';\n      }\n    }\n    // Redirigir al usuario según su rol\n    redirectToUserHome() {\n      const role = this.securityService.getUserRole();\n      switch (role) {\n        case 'admin':\n        case 'administrador':\n          this.router.navigate(['/administrador']);\n          break;\n        case 'directivo':\n          this.router.navigate(['/directivo']);\n          break;\n        default:\n          this.router.navigate(['/encuestas']);\n          break;\n      }\n    }\n    onForgotPassword() {\n      // Cuando hace clic en \"Olvidaste tu contraseña\"\n      console.log('Recuperar contraseña para:', this.usuario);\n      // Aqui iria la logica para enviar un email de recuperacion\n      alert('Funcionalidad de recuperación de contraseña no implementada aún.');\n    }\n    static ɵfac = function LoginComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || LoginComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.SecurityService));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: LoginComponent,\n      selectors: [[\"app-login\"]],\n      decls: 28,\n      vars: 10,\n      consts: [[\"loginForm\", \"ngForm\"], [1, \"login-container\"], [1, \"login-card\"], [1, \"login-header\"], [1, \"login-form\", 3, \"ngSubmit\"], [\"class\", \"error-message\", 4, \"ngIf\"], [1, \"form-group\"], [\"for\", \"usuario\"], [\"type\", \"text\", \"id\", \"usuario\", \"name\", \"usuario\", \"required\", \"\", \"placeholder\", \"Ingrese su usuario\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\", \"disabled\"], [\"for\", \"password\"], [\"type\", \"password\", \"id\", \"password\", \"name\", \"password\", \"required\", \"\", \"placeholder\", \"Ingrese su contrase\\u00F1a\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\", \"disabled\"], [1, \"form-group\", \"checkbox-group\"], [\"type\", \"checkbox\", \"id\", \"recordar\", \"name\", \"recordar\", 3, \"ngModelChange\", \"ngModel\", \"disabled\"], [\"for\", \"recordar\"], [\"type\", \"submit\", 1, \"btn-login\", 3, \"disabled\"], [4, \"ngIf\"], [1, \"login-links\"], [\"href\", \"#\", 3, \"click\"], [1, \"error-message\"]],\n      template: function LoginComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 1)(1, \"div\", 2)(2, \"div\", 3)(3, \"h2\");\n          i0.ɵɵtext(4, \"Iniciar Sesi\\u00F3n\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"p\");\n          i0.ɵɵtext(6, \"Sistema de Encuestas\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(7, \"form\", 4, 0);\n          i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_Template_form_ngSubmit_7_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onSubmit());\n          });\n          i0.ɵɵtemplate(9, LoginComponent_div_9_Template, 2, 1, \"div\", 5);\n          i0.ɵɵelementStart(10, \"div\", 6)(11, \"label\", 7);\n          i0.ɵɵtext(12, \"Usuario\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(13, \"input\", 8);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function LoginComponent_Template_input_ngModelChange_13_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.usuario, $event) || (ctx.usuario = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(14, \"div\", 6)(15, \"label\", 9);\n          i0.ɵɵtext(16, \"Contrase\\u00F1a\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"input\", 10);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function LoginComponent_Template_input_ngModelChange_17_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.password, $event) || (ctx.password = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(18, \"div\", 11)(19, \"input\", 12);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function LoginComponent_Template_input_ngModelChange_19_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            i0.ɵɵtwoWayBindingSet(ctx.recordarUsuario, $event) || (ctx.recordarUsuario = $event);\n            return i0.ɵɵresetView($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(20, \"label\", 13);\n          i0.ɵɵtext(21, \"Recordar usuario\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(22, \"button\", 14);\n          i0.ɵɵtemplate(23, LoginComponent_span_23_Template, 2, 0, \"span\", 15)(24, LoginComponent_span_24_Template, 2, 0, \"span\", 15);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(25, \"div\", 16)(26, \"a\", 17);\n          i0.ɵɵlistener(\"click\", function LoginComponent_Template_a_click_26_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onForgotPassword());\n          });\n          i0.ɵɵtext(27, \"\\u00BFOlvidaste tu contrase\\u00F1a?\");\n          i0.ɵɵelementEnd()()()()();\n        }\n        if (rf & 2) {\n          const loginForm_r3 = i0.ɵɵreference(8);\n          i0.ɵɵadvance(9);\n          i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n          i0.ɵɵadvance(4);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.usuario);\n          i0.ɵɵproperty(\"disabled\", ctx.isLoading);\n          i0.ɵɵadvance(4);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.password);\n          i0.ɵɵproperty(\"disabled\", ctx.isLoading);\n          i0.ɵɵadvance(2);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.recordarUsuario);\n          i0.ɵɵproperty(\"disabled\", ctx.isLoading);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"disabled\", !loginForm_r3.form.valid || ctx.isLoading);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.isLoading);\n        }\n      },\n      dependencies: [CommonModule, i3.NgIf, FormsModule, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.CheckboxControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm],\n      styles: [\".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background:linear-gradient(135deg,var(--primary-blue) 0%,var(--secondary-blue) 100%);padding:20px}.login-card[_ngcontent-%COMP%]{background:var(--white);border-radius:15px;box-shadow:var(--shadow-heavy);padding:40px;width:100%;max-width:400px;border:var(--border-light)}.login-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}.login-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--primary-blue);margin-bottom:5px;font-size:28px;font-weight:600}.login-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--medium-gray);margin:0;font-size:14px}.login-form[_ngcontent-%COMP%]{width:100%}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;color:var(--primary-blue);font-weight:500}.form-control[_ngcontent-%COMP%]{width:100%;padding:12px;border:2px solid var(--border-medium);border-radius:8px;font-size:16px;transition:all .3s ease;box-sizing:border-box;background-color:var(--white)}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--secondary-blue);box-shadow:0 0 0 3px #3b82f61a}.checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.checkbox-group[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:auto;margin:0}.btn-login[_ngcontent-%COMP%]{width:100%;padding:12px;background:linear-gradient(135deg,var(--primary-blue) 0%,var(--secondary-blue) 100%);color:var(--white);border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:transform .2s ease}.btn-login[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:var(--shadow-medium)}.btn-login[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.login-links[_ngcontent-%COMP%]{text-align:center;margin-top:20px}.login-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--secondary-blue);text-decoration:none;font-size:14px;transition:color .3s ease}.login-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--primary-blue);text-decoration:underline}.error-message[_ngcontent-%COMP%]{background-color:#fee;border:1px solid #fcc;color:#c33;padding:10px;border-radius:5px;margin-bottom:20px;font-size:14px;text-align:center}.btn-login[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;background-color:var(--medium-gray)}.btn-login[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{transition:opacity .3s ease}\"]\n    });\n  }\n  return LoginComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}